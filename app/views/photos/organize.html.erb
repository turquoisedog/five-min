<div data-controller="gallery">
  <%# select_tag 'group-selector',
                 options_from_collection_for_select(@groups, 'to_sgid', 'name'),
                 class: 'form-select ms-2',
                 placeholder: 'Select groups...',
                 multiple: true,
                 autocomplete: 'off',
                 data: { gallery_target: 'groupSelector' } %>
<!--  <button class="btn btn-secondary"-->
<!--          data-action="gallery#updateGroups">-->
<!--    Add to group(s)-->
<!--  </button>-->

  <div class="row">
    <div class="col-lg-2 vh-100 mb-5">
      <div class="card text-bg-light h-75">
        <div class="card-header">
          Filter
        </div>
        <div class="card-body p-1">
          <nav class="nav nav-pills flex-column">
            <%= filter_option_for 'ungrouped' %>
            <% @groups.each do |group| %>
              <%= filter_option_for group %>
            <% end %>
          </nav>
        </div>
      </div>
      <button type="button"
              class="btn btn-sm btn-outline-secondary mt-2"
              data-bs-toggle="modal"
              data-bs-target="#keyboardReference">
        <i class="bi bi-command"></i>
      </button>
    </div>

    <div class="col">
      <div class="hstack mb-3">
        <nav aria-label="breadcrumb" class="ms-1">
          <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item<%= ' active' unless @filtered_group %>">
              <%= @filtered_group ? link_to('All Photos', organize_photos_path) : 'All Photos' %>
            </li>
            <% if @filtered_group %>
              <li class="breadcrumb-item active"><%= @filtered_group.name %></li>
            <% end %>
          </ol>
        </nav>

        <div class="btn-group ms-auto" role="group" aria-label="Grouping actions">
          <button class="btn btn-outline-primary"
                  data-bs-toggle="button"
                  data-action="gallery#toggleSelecting"
                  data-gallery-target="toggler">
            Select
          </button>
          <button class="btn btn-outline-secondary"
                  data-bs-toggle="button"
                  data-action="gallery#openGroupModal"
                  data-gallery-target="groupButton"
                  disabled>
            Group...
          </button>
        </div>
      </div>

      <div class="row g-2 gallery" data-gallery-target="gallery">
        <% @photos.each do |photo| %>
          <div class="col-6 col-sm-4 col-md-2">
            <%= link_to photo, class: 'photo', data: { action: 'gallery#toggleSelect', sgid: photo.to_sgid_param } do %>
              <%= image_tag photo.asset.variant(:thumb), class: 'rounded' %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>

  </div>
</div>

<div class="modal fade"
     id="keyboardReference"
     tabindex="-1"
     aria-labelledby="keyboardReferenceLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="keyboardReferenceLabel">Keyboard Shortcuts</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <table class="table">
          <tbody>
            <thead>
              <tr>
                <th scope="col">Shortcut</th>
                <th scope="col">Behaviour</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">S</th>
                <td>Toggle selection mode</td>
              </tr>
              <tr>
                <th scope="row"><i class="bi bi-command"></i> A</th>
                <td>Select everything</td>
              </tr>
              <tr>
                <th scope="row"><i class="bi bi-command"></i> D</th>
                <td>Deselect everything</td>
              </tr>
              <tr>
                <th scope="row"><i class="bi bi-shift"></i><i class="bi bi-mouse2"></i></th>
                <td>After selecting an image, hold shift and select another to select the range between them</td>
              </tr>
            </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
